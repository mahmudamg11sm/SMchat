<!DOCTYPE html>
<html>
<head>
    <title>SM Chat</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
</head>
<body>

<div class="container">
    <div class="header">
        Welcome, {{ username }}
    </div>

    <div class="chat-box" id="chatBox"></div>

    <div class="input-box">
        <input id="msg" placeholder="Type message..." autocomplete="off">
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
const socket = io();
const username = "{{ username }}";

socket.on("message", data => {
    const box = document.getElementById("chatBox");
    const div = document.createElement("div");

    div.classList.add("message");
    div.classList.add(data.user === username ? "me" : "other");

    div.innerText = data.user + ": " + data.msg;
    box.appendChild(div);

    box.scrollTop = box.scrollHeight;
});

function sendMessage() {
    const input = document.getElementById("msg");
    if (input.value.trim() !== "") {
        socket.emit("send_message", input.value);
        input.value = "";
    }
}
</script>

</body>
</html>
